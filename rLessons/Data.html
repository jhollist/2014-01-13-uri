<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Dealing with Data in R</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Dealing with Data in R</h1>

<p><em>Note: This material is a mash-up from Jenny Bryan&#39;s <a href="http://www.stat.ubc.ca/%7Ejenny/STAT545A/quick-index.html">course materials on r</a> and Karthik Ram&#39;s <a href="https://github.com/swcarpentry/2013-10-09-canberra">material from the Canberra Software Carpentry R Bootcamp</a>.  Anything good is there becuase of Jenny and Karthik.  Mistakes are all mine.</em></p>

<h2>Index</h2>

<ul>
<li><a href="#r-data-structures">R Data Structures</a></li>
<li><a href="#file-io">File I/O</a></li>
<li><a href="#data-subsetting-and-manipulation">Data Subsetting and Manipulation</a></li>
</ul>

<h2>R Data Structures</h2>

<ul>
<li><p>To make the best of the R language, you&#39;ll need a strong understanding of the basic data types and data structures and how to operate on those.</p></li>
<li><p><strong>Very Important</strong> to understand because these are the things you will manipulate on a day-to-day basis in R. Most common source of frustration among beginners.</p></li>
<li><p>Everything in <code>R</code> is an object. </p></li>
</ul>

<p><code>R</code> has 5 basic atomic classes</p>

<ul>
<li>character</li>
<li>numeric (real or decimal)</li>
<li>integer</li>
<li>logical</li>
<li>complex</li>
</ul>

<table><thead>
<tr>
<th>Example</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>&ldquo;a&rdquo;, &ldquo;swc&rdquo;</td>
<td>character</td>
</tr>
<tr>
<td>2, 15.5</td>
<td>numeric</td>
</tr>
<tr>
<td>2 (usually add a <code>L</code> at end to denote integer)</td>
<td>integer</td>
</tr>
<tr>
<td><code>TRUE</code>, <code>FALSE</code></td>
<td>logical</td>
</tr>
<tr>
<td>1+4i</td>
<td>complex</td>
</tr>
</tbody></table>

<pre><code class="r">typeof()  # what is it?
length()  # how long is it? What about two dimensional objects?
attributes()  # does it have any metadata?
</code></pre>

<p>R also has many data structures. These include</p>

<ul>
<li>vector</li>
<li>list</li>
<li>matrix</li>
<li>data frame</li>
<li>factors</li>
<li>tables</li>
</ul>

<h3>Vectors</h3>

<p>A vector is the most common and basic data structure in <code>R</code> and is pretty much the workhorse of R. Vectors can be of two types:</p>

<ul>
<li>atomic vectors</li>
<li>lists</li>
</ul>

<p><strong>Atomic Vectors</strong>
A vector can be a vector of characters, logical, integers or numeric.</p>

<p>Create an empty vector with <code>vector()</code></p>

<pre><code class="r">x &lt;- vector()
x
# with a pre-defined length
x &lt;- vector(length = 10)
x
# with a length and type
vector(&quot;character&quot;, length = 10)
vector(&quot;numeric&quot;, length = 10)
vector(&quot;integer&quot;, length = 10)
vector(&quot;logical&quot;, length = 10)
</code></pre>

<p>The general pattern is <code>vector(class of object, length)</code>.  You can also create vectors by concactenating them using the <code>c()</code> function.</p>

<p>Various examples:</p>

<pre><code class="r">x &lt;- c(1, 2, 3)
</code></pre>

<p>x is a numeric vector. These are the most common kind. They are numeric objects and are treated as double precision real numbers. To explicitly create integers, add a <code>L</code> at the end.</p>

<pre><code class="r">x1 &lt;- c(1L, 2L, 3L)
</code></pre>

<p>You can also have logical vectors. </p>

<pre><code class="r">y &lt;- c(TRUE, TRUE, FALSE, FALSE)
</code></pre>

<p>Finally you can have character vectors:</p>

<pre><code class="r">z &lt;- c(&quot;Alec&quot;, &quot;Dan&quot;, &quot;Rob&quot;, &quot;Karthik&quot;)
</code></pre>

<p><strong>Examine your vector</strong>  </p>

<pre><code class="r">typeof(z)
length(z)
class(z)
str(z)
</code></pre>

<p>Question: Do you see a property that&#39;s common to all these vectors above?</p>

<p><strong>Add elements</strong></p>

<pre><code class="r">z &lt;- c(z, &quot;Annette&quot;)
z
</code></pre>

<p>More examples of vectors</p>

<pre><code class="r">x &lt;- c(0.5, 0.7)
x &lt;- c(TRUE, FALSE)
x &lt;- c(T, F)
x &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;)
x &lt;- 9:100
x &lt;- c(i + 0, 2 + 4)
</code></pre>

<p>You can also create vectors as sequence of numbers</p>

<pre><code class="r">series &lt;- 1:10
seq(10)
seq(1, 10, by = 0.1)
</code></pre>

<p><strong>Other objects</strong></p>

<p><code>Inf</code> is infinity. You can have positive or negative infinity.</p>

<pre><code class="r">1/0
# [1] Inf
1/Inf
# [1] 0
</code></pre>

<p><code>NaN</code> means Not a number. it&#39;s an undefined value.</p>

<pre><code class="r">0/0
NaN.
</code></pre>

<p>Each object has an attribute. Attribues can be part of an object of R. These include </p>

<ul>
<li>names</li>
<li>dimnames</li>
<li>length</li>
<li>class</li>
<li>attributes (contain metadata)</li>
</ul>

<p>For a vector, <code>length(vector_name)</code> is just the total number of elements.</p>

<p><strong>What happens when you mix types?</strong></p>

<p>R will create a resulting vector that is the least common denominator. The coercion will move towards the one that&#39;s easiest to coerce to.</p>

<p><strong>Guess what the following do without running them first</strong></p>

<pre><code class="r">xx &lt;- c(1.7, &quot;a&quot;)
xx &lt;- c(TRUE, 2)
xx &lt;- c(&quot;a&quot;, TRUE)
</code></pre>

<p>This is called implicit coercion.  You can also coerce vectors explicitly using the <code>as.&lt;class_name&gt;</code>. Example</p>

<pre><code class="r">as.numeric()
as.character()
</code></pre>

<p>When you coerce an existing numeric vector with <code>as.numeric()</code>, it does nothing.</p>

<pre><code class="r">x &lt;- 0:6
as.numeric(x)
as.logical(x)
as.character(x)
as.complex(x)
</code></pre>

<p>Sometimes coercions, especially nonsensical ones wont work.</p>

<pre><code class="r">x &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)
as.numeric(x)
as.logical(x)
# both don&#39;t work
</code></pre>

<p><strong>Sometimes there is implicit conversion</strong></p>

<pre><code class="r">1 &lt; &quot;2&quot;
&quot;1&quot; &gt; 2
</code></pre>

<h3>Matrix</h3>

<p>Matrices are a special vector in R. They are not a separate class of object but simply a vector but now with dimensions added on to it. Matrices have rows and columns. </p>

<pre><code class="r">m &lt;- matrix(nrow = 2, ncol = 2)
m
dim(m)
# same as
attributes(m)
</code></pre>

<p>Matrices are constructed columnwise. </p>

<pre><code class="r">m &lt;- matrix(1:6, nrow = 2, ncol = 3)
</code></pre>

<p>Other ways to construct a matrix</p>

<pre><code class="r">m &lt;- 1:10
dim(m) &lt;- c(2, 5)
</code></pre>

<p>This takes a vector and transform into a matrix with 2 rows and 5 columns.</p>

<p>Another way is to bind columns or rows using <code>cbind()</code> and <code>rbind()</code>.</p>

<pre><code class="r">x &lt;- 1:3
y &lt;- 10:12
cbind(x, y)
# or
rbind(x, y)
</code></pre>

<hr/>

<h3>List</h3>

<p>In R lists act as containers. Unlike atomic vectors, its contents are not restricted to a single mode and can encompass any data type. Lists are sometimes called recursive vectors, because a list can contain other lists. This makes them fundamentally different from atomic vectors. </p>

<p>List is a special vector. Each element can be a different class.</p>

<p>Create lists using <code>list</code> or coerce other objects using <code>as.list()</code></p>

<pre><code class="r">x &lt;- list(1, &quot;a&quot;, TRUE, 1 + 4)
</code></pre>

<pre><code class="r">x &lt;- 1:10
x &lt;- as.list(x)
length(x)
</code></pre>

<p>What is the class of <code>x[1]</code>?<br/>
how about <code>x[[1]]</code>?</p>

<pre><code class="r">xlist &lt;- list(a = &quot;Karthik Ram&quot;, b = 1:10, data = head(iris))
</code></pre>

<p>what is the length of this object?
what about its structure?</p>

<p>List can contain as many lists nested inside.</p>

<pre><code class="r">temp &lt;- list(list(list(list())))
temp
is.recursive(temp)
</code></pre>

<p>Lists are extremely useful inside functions. You can &ldquo;staple&rdquo; together lots of different kinds of results into a single object that a function can return.</p>

<p>It doesn&#39;t print out like a vector. Prints a new line for each element.</p>

<p>Elements are indexed by double brackets. Single brackets will still return a(nother) list.</p>

<hr/>

<h3>Factors</h3>

<p>Factors are special vectors that represent categorical data. Factors can be ordered or unordered and are important when for modelling functions such as <code>lm()</code> and <code>glm()</code> and also in plot methods.</p>

<p>Factors can only contain pre-defined values.</p>

<p>Factors are pretty much integers that have labels on them.  While factors look (and often behave) like character vectors, they are actually integers under the hood, and you need to be careful when treating them like strings. Some string methods will coerce factors to strings, while others will throw an error.</p>

<p>Sometimes factors can be left unordered. Example: male, female</p>

<p>Other times you might want factors to be ordered (or ranked). Example: low, medium, high. </p>

<p>Underlying it&#39;s represented by numbers 1,2,3.</p>

<p>They are better than using simple integer labels because factors are what are called self describing. male and female is more descriptive than 1s and 2s. Helpful when there is no additional metadata.</p>

<p>Which is male? 1 or 2? You wouldn&#39;t be able to tell with just integer data. Factors have this information built in.</p>

<p>Factors can be created with <code>factor()</code>. Input is a character vector.</p>

<pre><code class="r">x &lt;- factor(c(&quot;yes&quot;, &quot;no&quot;, &quot;no&quot;, &quot;yes&quot;, &quot;yes&quot;))
x
</code></pre>

<p><code>table(x)</code> will return a frequency table.</p>

<p><code>unclass(x)</code> strips out the class information.</p>

<p>In modeling functions, importnat to know whta baseline levels is.
This is the first factor but by default the ordering is determined by alphabetical order of words entered. You can change this by speciying the levels.</p>

<pre><code class="r">x &lt;- factor(c(&quot;yes&quot;, &quot;no&quot;, &quot;yes&quot;), levels = c(&quot;yes&quot;, &quot;no&quot;))
</code></pre>

<h3>Data frame</h3>

<p>A data frame is a very important data type in R. It&#39;s pretty much the de facto data structure for most tabular data and what we use for statistics.</p>

<p>data frames can have additional attributes such as <code>rownames()</code>. This can be useful for annotating data, like subject_id or sample_id. But most of the time they are not used.</p>

<p>e.g. <code>rownames()</code>
useful for annotating data. subject names.
other times they are not useful.</p>

<ul>
<li><p>Data frames Usually created by read.csv and read.table.</p></li>
<li><p>Can convert to <code>matrix</code> with <code>data.matrix()</code></p></li>
<li><p>Coercion will force and not always what you expect.</p></li>
<li><p>Can also create with <code>data.frame()</code> function.</p></li>
</ul>

<p>With and data frame, you can do <code>nrow(df)</code> and <code>ncol(df)</code>
rownames are usually 1..n.</p>

<p><strong>Combining data frames</strong></p>

<pre><code class="r">df &lt;- data.frame(id = letters[1:10], x = 1:10, y = rnorm(10))
df
</code></pre>

<p><code>cbind(df, data.frame(z = 4))</code></p>

<p>When you combine column wise, only row numbers need to match. If you are adding a vector, it will get repeated.</p>

<p><strong>Useful functions</strong><br/>
<code>head()</code> - see first 5 rows
<code>tail()</code> - see last 5 rows
<code>dim()</code> - see dimensions
<code>nrow()</code> - number of rows
<code>ncol()</code> - number of columns
<code>str()</code> - structure of each column
<code>names()</code> - will list column names for a data.frame (or any object really).
<code>summary()</code> - summarizes each column in a data frame</p>

<p>A data frame is a special type of list where every element of a list has same length.</p>

<p>See that it is actually a special list:</p>

<pre><code>&gt; is.list(iris)
[1] TRUE
&gt; class(iris)
[1] &quot;data.frame&quot;
 &gt; 
</code></pre>

<h2></h2>

<p><strong>Naming objects</strong>  </p>

<p>Other R objects can also have names not just true for data.frames. Adding names is helpful since it&#39;s useful for readable code and self describing objects.</p>

<pre><code class="r">x &lt;- 1:3
names(x) &lt;- c(&quot;karthik&quot;, &quot;ram&quot;, &quot;rocks&quot;)
x
</code></pre>

<p>Lists can also have names.</p>

<pre><code class="r">x &lt;- as.list(1:10)
names(x) &lt;- letters[seq(x)]
x
</code></pre>

<p>Finally matrices can have names and these are called <code>dimnames</code></p>

<pre><code class="r">m &lt;- matrix(1:4, nrow = 2)
dimnames(m) &lt;- list(c(&quot;a&quot;, &quot;b&quot;), c(&quot;c&quot;, &quot;d&quot;))
# first element = rownames second element = colnames
</code></pre>

<hr/>

<h3>Missing values</h3>

<p>dennoted by <code>NA</code> and/or <code>NaN</code> for undefined mathematical operations.</p>

<pre><code class="r">is.na()
is.nan()
</code></pre>

<p>check for both.</p>

<p>NA values have a class. So you can have both an integer NA and a missing character NA.</p>

<p>Nan is also NA. But not the other way around.</p>

<pre><code class="r">x &lt;- c(1, 2, NA, 4, 5)
is.na(x)  #returns logical. shows third
is.nan(x)  #none are NaN.
</code></pre>

<pre><code class="r">x &lt;- c(1, 2, NA, NaN, 4, 5)
is.na(x)  #shows 2 TRUE.
is.nan(x)  #shows 1 TRUE
</code></pre>

<hr/>

<h3>Refresher on data types</h3>

<p><img src="https://raw.github.com/swcarpentry/2013-10-09-canberra/master/01-R-basics/data-types.png" alt=""/></p>

<h2>File I/O</h2>

<h3>Input output operations</h3>

<h3>Inputting data</h3>

<pre><code class="r">x &lt;- scan(&quot;data_file.txt&quot;)  #Example Data created by Jeff Hollister
# add a separator
x &lt;- scan(&quot;messy_data.txt&quot;, what = &quot; &quot;, sep = &quot;\n&quot;)  #Example Data created by Karthik Ram
# or read data from the console
x &lt;- scan()
# keep entering values and hit an empty return key to end Note the class of
# the data
class(x)
</code></pre>

<p>Reading single lines (e.g. user input)</p>

<pre><code class="r">variable &lt;- readline()
class(variable)
# or provide more information
variable &lt;- readline(&quot;Enter number of simulations: &quot;)
</code></pre>

<h3>Reading files</h3>

<p>Most plain text files can be read with <code>read.table</code> or variants thereof (such as <code>read.csv</code>).</p>

<pre><code class="r">df &lt;- read.table(&quot;data.dat&quot;, header = TRUE)  #Example Data created by Jeff Hollister
# Note class of df
class(df)
</code></pre>

<p>or using <code>readLines</code></p>

<pre><code class="r">dt &lt;- readLines(&quot;messy_data.txt&quot;)
</code></pre>

<h3>Files from the web</h3>

<pre><code>url &lt;- &quot;https://raw.github.com/karthikram/ggplot-lecture/master/climate.csv&quot;
my_data &lt;- read.csv(url, header = TRUE)
</code></pre>

<h3>Local file operations</h3>

<p>One can list files from any local source as well.  This is review from the first R lesson, but handy to repeat here.</p>

<pre><code class="r">list.files()
file.info()
dir()
file.exists()
getwd()
setwd()
</code></pre>

<hr/>

<h2>Output</h2>

<h3>Writing files</h3>

<p>Saving files is easy in R. We have loaded the <code>iris</code> dataset into our memory, if not type <code>data(iris)</code> in the conosle. Can you save this back to a <code>csv</code> file to disk with the name <code>tgac_iris.csv</code>?</p>

<p>What commands did you use?</p>

<h3>Short term storage</h3>

<pre><code class="r">saveRDS(iris, file = &quot;tgac_iris.rds&quot;)
iris_data &lt;- readRDS(&quot;tgac_iris.rds&quot;)
</code></pre>

<p>This is great for short term storage. All factors and other modfications to the dataset will be preserved. However, only R can read these data back and not the best option if you want to keep the file stored in the easiest format.</p>

<h3>Long-term storage</h3>

<pre><code class="r">write.csv(iris, file = &quot;tgac_iris.csv&quot;, row.names = FALSE)
</code></pre>

<h3>Easy to store compressed files to save space:</h3>

<pre><code class="r">write.csv(diamonds, file = bzfile(&quot;diamonds.csv.bz2&quot;), row.names = FALSE)
</code></pre>

<h3>Reading is even easier:</h3>

<pre><code class="r">diamonds5 &lt;- read.csv(&quot;diamonds.csv.bz2&quot;)
</code></pre>

<p>Files stored with <code>saveRDS()</code> are automatically compressed.</p>

<h3>Now a database example (teaser for tomorrow)</h3>

<p>There are many options for using R to access data stored in a databse.  One simple and lightweight example is using <code>sqlite</code> and the R Package <code>RSQLite</code>.</p>

<p>This is a bit more involved, but wanted to show this simply as an example of what is possible.  Skys the limit on what type of database you can use.</p>

<pre><code class="r"># If not already installed install.packages(&#39;RSQLite&#39;)
library(RSQLite)
con &lt;- dbConnect(dbDriver(&quot;SQLite&quot;), dbname = &quot;diamonds.sqlite&quot;)
dbWriteTable(con, &quot;tDiamonds&quot;, diamonds5)
list.files(pattern = &quot;^dia&quot;)
# And to prove it did someting read the new table back in
sqliteDiamonds &lt;- dbReadTable(con, &quot;tDiamonds&quot;)
head(sqliteDiamonds)
dbDisconnect(con)
</code></pre>

<h3>Data Structure and File I/O Exercise</h3>

<p>For this exercise we will practice what we have learned so far.  You will download three files, create data.frames, and answer some questions about the data.  Only use R for these steps and save everything as a script with simple comments.</p>

<ol>
<li>Download the <a href="http://water.epa.gov/type/lakes/assessmonitor/lakessurvey/upload/NLA2007_SampledLakeInformation_20091113.csv">2007 National Lakes Assessment Station Information</a></li>
<li>Download the <a href="http://water.epa.gov/type/lakes/assessmonitor/lakessurvey/upload/NLA2007_WaterQuality_20091123.csv">2007 National Lakes Assessment Water Quality Data</a></li>
<li>Download the <a href="http://water.epa.gov/type/lakes/assessmonitor/lakessurvey/upload/NLA2007_Buffer_Landuse_Metrics_20091022.csv">2007 National Lakes Assessment Buffer Landuse</a></li>
<li>Create a data frame for each file.</li>
<li>How many rows are in the water quality data? How many columns?</li>
<li>How many rows and columns are in the Landuse data?</li>
<li>What is the name of the first column in each dataframe</li>
<li>What class of data is this column?</li>
<li>What are the max, min, and mean values for <code>PCT_DEVELOPED_BUFR</code> in the buffer landuse data?</li>
<li>What are the max, min and mean values for <code>NTL</code> in the water quality data?</li>
</ol>

<h2>Data Subsetting and Manipulation</h2>

<h3>Subsetting data</h3>

<p>R has many powerful subset operators and mastering them will allow you to easily perform complex operation on any kind of dataset. Allows you to manipulate data very succinctly.</p>

<p>As the last section for this topic we&#39;ll cover:</p>

<ul>
<li>The three subsetting operators,</li>
<li>The six types of subsetting,</li>
<li>Important difference in subsetting behaviour for different objects </li>
<li>Using subsetting in conjunction with assignment</li>
</ul>

<h3>Subsetting atomic vectors</h3>

<pre><code class="r">x &lt;- c(5.4, 6.2, 7.1, 4.8)
</code></pre>

<p><strong>We can subset this in 5 ways</strong></p>

<p>1.) Using positive integers</p>

<pre><code class="r">x[1]
x[c(3, 1)]
# We can duplicate indices
x[c(1, 1)]
# Real numbers are silently truncated to integers
x[c(2.1, 2.9)]
</code></pre>

<p>2.) Using negative integers</p>

<pre><code class="r"># skip the first element
x[-1]
# skip the first and the fifth
x[-c(1, 5)]
</code></pre>

<p>3.) Using logical operators</p>

<pre><code class="r">x[c(TRUE, TRUE, FALSE, FALSE)]
# or based on a condition
x[x &gt; 3]
x[which(x &gt; 3)]
# Also see `which.max()` and `which.min()`
</code></pre>

<p>4.) with nothing</p>

<pre><code class="r">x[]
# useful when dealing with 2 or higher dimensional objects
</code></pre>

<p>5.) with zero</p>

<pre><code class="r">x[0]
# helpful for generating test data or creating empty objects
</code></pre>

<p>6.) Referencing objects by their names</p>

<pre><code class="r">y &lt;- setNames(x, letters[1:4])

y[c(&quot;d&quot;, &quot;c&quot;, &quot;a&quot;)]

# We can also repeat indices
y[c(&quot;a&quot;, &quot;a&quot;, &quot;a&quot;)]

# Names are always matched exactly, not partially
z &lt;- c(abc = 1, def = 2)
z[c(&quot;a&quot;, &quot;d&quot;)]
</code></pre>

<hr/>

<h3>Subsetting lists</h3>

<p>Subsetting a list works in exactly the same way as subsetting an atomic vector. Subsetting a list with [ will always return a list: <code>[[</code><code>and</code>$, as described below, let you pull out the components of the list.</p>

<pre><code class="r">x &lt;- as.list(1:10)

x[1:5]

# What class is this object?
</code></pre>

<p>To extract individual elements inside a list, use the <code>[[</code> operator</p>

<pre><code class="r"># to get element 5

x[[5]]

class(x[[5]])

another_variable &lt;- x[[5]]

</code></pre>

<p>Or using their names</p>

<pre><code class="r">names(x) &lt;- letters[1:5]

x$a
x[[&quot;a&quot;]]
</code></pre>

<h3>Subsetting matrices</h3>

<pre><code class="r">a &lt;- matrix(1:9, nrow = 3)
colnames(a) &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;)
a[1:2, ]
a[c(T, F, T), c(&quot;B&quot;, &quot;A&quot;)]
a[0, -2]
</code></pre>

<h3>Subsetting data frames</h3>

<pre><code class="r">df &lt;- data.frame(x = 1:3, y = 3:1, z = letters[1:3])
df[df$x == 2, ]
df[c(1, 3), ]

# There are two ways to select columns from a data frame Like a list:
df[c(&quot;x&quot;, &quot;z&quot;)]

# Like a matrix
df[, c(&quot;x&quot;, &quot;z&quot;)]


# There&#39;s an important difference if you select a simple column: matrix
# subsetting simplifies by default, list subsetting does not.
df[&quot;x&quot;]

df[, &quot;x&quot;]
</code></pre>

<h3>Combining data frames</h3>

<p>We have already seen some ways to combine vectors together and create <code>data.frames</code> using <code>rbind</code> to add rows and <code>cbind</code> to combine columns.  You can accomplish in additional ways as well</p>

<pre><code class="r"># Review of creating data frame with rbind() and cbind()
x &lt;- c(1, 2, 3, 4, 5)
y &lt;- c(5, 6, 7, 8, 9)
df &lt;- rbind(x, y)
# coerce to data.frame. rbind creates a matrix with row.names
as.data.frame(df)
df &lt;- cbind(x, y)
# coerce to data.frame. rbind creates a matrix with row.names
as.data.frame(df)
# you can also use data.frame(), similar results to cbind
df &lt;- data.frame(x, y)
df
</code></pre>

<p>These methods work well if your vectors are of the same length, but that is not often the case.  A very common situation is two data frames that share an ID value and you need to merge these together.  In other words, a join.  That cna be accomplished with <code>merge</code>.</p>

<pre><code class="r"># create test data.frame 1
df1 &lt;- data.frame(id = c(1:10), data1 = seq(1, 20, 2), data2 = jitter(seq(1, 
    20, 2), 10))

# create test data.frame 2
df2 &lt;- data.frame(id = c(1, 1, 2, 2, 3, 4, 7, 8, 8, 9, 10, 11, 12, 12, 4), data1 = seq(1, 
    30, 2), data2 = jitter(seq(1, 30, 2), 10))

# now we can merge
dfm &lt;- merge(df1, df2, by = &quot;id&quot;)
dfm
dim(dfm)

# often we want to make sure all of one df is preserved
dfm &lt;- merge(df1, df2, by = &quot;id&quot;, all.x = TRUE)
dfm
dim(dfm)
</code></pre>

<h2>Apply Functions</h2>

<p>One of the greatest joys of vectorized operations is being able to use the entire family of <code>apply</code> functions that are available in base <code>R</code>.</p>

<p>These include:</p>

<pre><code class="r">apply
by
lapply
tapply
sapply
</code></pre>

<h3>apply</h3>

<pre><code class="r">m &lt;- matrix(c(1:10, 11:20), nrow = 10, ncol = 2)
# 1 is the row index 2 is the column index
apply(m, 1, sum)
apply(m, 2, sum)
apply(m, 1, mean)
apply(m, 2, mean)
</code></pre>

<h3>by</h3>

<pre><code class="r">head(iris)
by(iris[, 1:2], iris[, &quot;Species&quot;], summary)
by(iris[, 1:2], iris[, &quot;Species&quot;], sum)
</code></pre>

<h3>tapply</h3>

<p>Two examples</p>

<pre><code class="r">df &lt;- data.frame(names = sample(c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), 10, rep = T), length = rnorm(10))
tapply(df$length, df$names, mean)

# Now with a more familiar dataset
tapply(iris$Petal.Length, iris$Species, mean)
</code></pre>

<h3>lapply (and llply)</h3>

<p>What it does: Returns a list of same length as the input. 
Each element of the output is a result of applying a function to the corresponding element.</p>

<pre><code class="r">my_list &lt;- list(a = 1:10, b = 2:20)
lapply(my_list, mean)
</code></pre>

<h3>sapply</h3>

<p>sapply is a more user friendly version of <code>lapply</code> and will return a list of matrix where appropriate.</p>

<p>Let&#39;s work with the same list we just created.</p>

<pre><code class="r">my_list
x &lt;- sapply(my_list, mean)
class(x)
</code></pre>

<h3>replicate</h3>

<p>An extremely useful function to generate datasets for simulation purposes. </p>

<pre><code class="r">replicate(10, rnorm(10))
replicate(10, rnorm(10), simplify = TRUE)
# The final arguments turns the result into a vector or matrix if possible.
</code></pre>

<h3>mapply</h3>

<p>Its more or less a multivariate version of <code>sapply</code>. It applies a function to all corresponding elements of each argument. </p>

<p>example:</p>

<pre><code class="r">list_1 &lt;- list(a = c(1:10), b = c(11:20))
list_2 &lt;- list(c = c(21:30), d = c(31:40))
mapply(sum, list_1$a, list_1$b, list_2$c, list_2$d)
</code></pre>

<h3>plyr and reshape</h3>

<p>Two packages that are very widely used for data manipulation are <code>plyr</code> and <code>reshape</code>  The argument for their use is that they simplify many of the common data manipulation tasks, althought they do require a slightly different way of thinking about manipulating data in R.  As such, they are a bit beyond the scope of what we are covering.  But they are widely used enough and powerful enough to bare mention.</p>

<p>For more on these, see Karthik Ram&#39;s Canberra Bootcamp Materials on <a href="https://github.com/swcarpentry/2013-10-09-canberra/blob/master/03-data-manipulation/03-split-apply.md"><code>plyr</code> and <code>reshape</code></a></p>

<h2>Data Manipulation Exercise</h2>

<p>In our last exercise, we pulled in three datasets, created data frames from them and answered some basic questions about those data frames.  One of the first things you will notice is that EPA is very fond of large, verbose data structures.  There is a lot more informaiton in these three data frames than we really would like.  The purpose of this exercise is to pull out information we would like to keep, create a single data frame for some future analysis, do some basic analysis, and write the resulting data frame to disc. As before, all steps must be done in R and save your commands in a commented script.</p>

<ol>
<li>Subset your station information data frame so that you only have the following columns: SITE_ID, VISIT_NO, SITE_TYPE, STATE_NAME</li>
<li>Subset your water quality information so that you have: SITE_ID, NTL, PTL, CHLA </li>
<li>Susbset your landuse data frame so that you have: SITE_ID, PCT_DEVELOPED_BUFR,  PCT_FOREST_BUFR, PCT_AGRIC_BUFR, and PCT_WETLAND_BUFR.</li>
<li>Subset your streamlined verison of station information (created in step 1) so that only the first visit of the probability lakes are returned.  First visits are those records that have a VISIT_NO of 1 and probability lakes are SITE_TYPE of PROB_lake.</li>
<li>Create a single data frame that combines the station information from step 4, the water quality info from step 2, and the landuse information from step 3. </li>
<li>How many rows and columns in this new data frame?  Is it what you expected?</li>
<li>Calculate the mean, median, min, and max (1st and 3rd quartiles ok too) for each of the data columns.  You can do this many ways, but you have the tools to do it in one, very clean line of code!</li>
<li>Once you are certain your new data frame has all the proper rows and columns, write the data frame out to a .csv file.  We will be using this file as input later, so keep track of where you put it.</li>
</ol>

</body>

</html>

